```java
android:layout_marginTop="-45dp"
    //无视vertical 直接向上面跑
    、、test
```

### Shape    

> <font color=gray>在项目中经常会给控件定义背景，有时候有些界面可以叫UI做好，但如何显示的更加的贴近用户，则需要我们客户端去优化。如果在设置背景Android:background=“图片、颜色”，设置单一的属性并不能带来更好的体验。我们此时就可以使用shape属性作为控件的背景。</font>

**创建位置**：

<font color=orange size=4>1.在res/drawable下新建一个xml文件；</font>

<font color=orange size=4>2.在代码中引用这个xml文件，引用方式和图片一样。</font>

**功能：**

> - corners - 圆角
> - gradient - 渐变
> - padding - 内容离边界距离
> - size - 大小　
> - solid - 填充颜色
> - stroke - 描边



**具体使用**

```java
<?xml version="1.0" encoding="utf-8"?>
<shape
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape=["rectangle" | "oval" | "line" | "ring"]      //共有4种类型，矩形（默认）/椭圆形/直线形/环形
    // 以下4个属性只有当类型为环形时才有效
    android:innerRadius="dimension"     //内环半径
    android:innerRadiusRatio="float"    //内环半径相对于环的宽度的比例，比如环的宽度为50,比例为2.5,那么内环半径为20
    android:thickness="dimension"   //环的厚度
    android:thicknessRatio="float"     //环的厚度相对于环的宽度的比例
    android:useLevel="boolean">    //如果当做是LevelListDrawable使用时值为true，否则为false.
 
    <corners    //定义圆角  圆角一般会让人看起来更加丝滑一些
        android:radius="dimension"      //全部的圆角半径
        android:topLeftRadius="dimension"   //左上角的圆角半径
        android:topRightRadius="dimension"  //右上角的圆角半径
        android:bottomLeftRadius="dimension"    //左下角的圆角半径
        android:bottomRightRadius="dimension" />    //右下角的圆角半径
 
    <gradient   //定义渐变效果
        android:type=["linear" | "radial" | "sweep"]    //共有3中渐变类型，线性渐变（默认）/放射渐变/扫描式渐变
        android:angle="integer"     //渐变角度，必须为45的倍数，0为从左到右，90为从上到下
        android:centerX="float"     //渐变中心X的相当位置，范围为0～1
        android:centerY="float"     //渐变中心Y的相当位置，范围为0～1
        android:startColor="color"      //渐变开始点的颜色
        android:centerColor="color"     //渐变中间点的颜色，在开始与结束点之间
        android:endColor="color"    //渐变结束点的颜色
        android:gradientRadius="float"  //渐变的半径，只有当渐变类型为radial时才能使用
        android:useLevel=["true" | "false"] />  //使用LevelListDrawable时就要设置为true。设为false时才有渐变效果
 
    <padding    //内部边距
        android:left="dimension"
        android:top="dimension"
        android:right="dimension"
        android:bottom="dimension" />
 
    <size   //自定义的图形大小
        android:width="dimension"
        android:height="dimension" />
 
    <solid  //内部填充颜色
        android:color="color" />
 
    <stroke     //描边
        android:width="dimension"   //描边的宽度
        android:color="color"   //描边的颜色
        // 以下两个属性设置虚线
        android:dashWidth="dimension"   //虚线的宽度，值为0时是实线
        android:dashGap="dimension" />      //虚线的间隔
</shape>
```

**Demo**

**1.gradient渐变**

![img](https://img-blog.csdnimg.cn/2020110511533365.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xvdmVGSE0=,size_16,color_FFFFFF,t_70)

**2.stroke边框**

![img](https://img-blog.csdnimg.cn/20201105133940962.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xvdmVGSE0=,size_16,color_FFFFFF,t_70)















### Spinner

##### **样式：**

![img](https://img-blog.csdnimg.cn/20201216135450298.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzMjEwMDQy,size_16,color_FFFFFF,t_70)

##### **使用步骤：**

1.首先在xml文件中添加这个控件

```java
   <Spinner
            android:id="@+id/spinner"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:entries="@array/spinner_content"/>
```

2.在res的values中创建一个数组

<img src="C:\Users\liukai\AppData\Roaming\Typora\typora-user-images\image-20230224154722660.png" alt="image-20230224154722660" style="zoom: 67%;" />

3.写入下拉内容

```java
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string-array name="spinner_content">
        <item>Android</item>
        <item>java </item>
        <item>c语言</item>
        <item>php</item>
        <item>python</item>
    </string-array>
</resources>
```

4.在java文件中绑定并监听

```java
public class MainActivity extends AppCompatActivity {
    private Spinner spinner;
 
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
 
        spinner = findViewById(R.id.spinner);
 
        spinner.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView<?> parent, View view, int position, long id) {
                String[] spinner_content = getResources().getStringArray(R.array.spinner_content);//创建下拉内容的字符串组
                Toast.makeText(MainActivity.this, "你点击的是:" + spinner_content[position],
                        Toast.LENGTH_SHORT).show();
            }
            @Override
            public void onNothingSelected(AdapterView<?> parent) {
 
            }
        });
    }
}
```

##### **spinner常用方法**

```java
// 下拉宽度
spinner.setDropDownWidth(500);
// 下拉水平方向偏移
spinner.setDropDownHorizontalOffset(50);
// 下拉的垂直方向偏移
spinner.setDropDownVerticalOffset(50);
下面俩都可以
// 下拉背景
spinner.setPopupBackgroundDrawable(ContextCompat.getDrawable(this,
        R.drawable.ic_launcher_background));
// 下拉背景
spinner.setPopupBackgroundResource(R.drawable.ic_launcher_background);
```

##### 动态添加spinner内容：





### Switch

##### **样式：**

![image-20230303212813959](D:\Typora\typora-user-images/image-20230303212813959.png)

##### **相关属性：**

> - android:showText：设置on/off的时候是否显示文字,boolean
> - android:splitTrack：是否设置一个间隙，让滑块与底部图片分隔,boolean
> - android:switchMinWidth：设置开关的最小宽度
> - android:switchPadding：设置滑块内文字的间隔
> - android:switchTextAppearance：设置开关的文字外观，暂时没发现有什么用…
> - android:textOff：按钮没有被选中时显示的文字
> - android:textOn：按钮被选中时显示的文字
> - android:textStyle：文字风格，粗体，斜体写划线那些
> - android:track：底部的图片
> - android:thumb：滑块的图片

##### **使用步骤：**

```java
<Switch
        android:id="@+id/switch1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textOn="关"
        android:textOff="开"
        android:switchMinWidth="40dp"
        android:track="@drawable/switch_track"
        android:thumb="@android:color/transparent" />
```

##### **监听：**

```java
mSwitch1.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
            @Override
            public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
                if (isChecked){//当开关状态为开时执行
                    //Todo
                }else {
                    //Todo
                }
            }
        });
```

### Swiperefreshlayout

##### **样式：**<img src="https://img-blog.csdnimg.cn/20200611043715245.gif" alt="在这里插入图片描述" style="zoom: 80%;" />

##### **常用方法及进阶：**

|                           **方法**                           |                           **解释**                           |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
|           setColorSchemeResources(int…colorReslds)           | 设置下拉进度条的颜色主题，参数可变，并且是资源id，最多设置四种不同的颜色。 |
|       setProgressBackgroundSchemeResource(int coloRes)       |             设置下拉进度条的背景颜色,默认白色。              |
|                        isRefreshing()                        |                判断当前的状态是否是刷新状态。                |
| setOnRefreshListener(SwipeRefreshLayout.OnRefreshListener listener) | 设置监听，需要重写onRefresh()方法， 顶部下拉时会调用这个方法，在里面实现请求数据的逻辑，设置下拉进度条消失等等。 |
|              setRefreshing(boolean refreshing)               |      设置刷新状态，true表示正在刷新，false表示取消刷新       |

> SwipeRefreshLayout 还提供了一些方法设置进度的样式，滑动的开始位置和结束位置等

|                          **方法名**                          |                           **作用**                           |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
|                      setSize(int size)                       |       设置进度View样式的大小，只有两个值DEFAULT和LARGE       |
|   setProgressViewOffset(boolean scale, int start, int end)   | 设置进度View下拉的起始点和结束点，scale 是指设置是否需要放大或者缩小动画 |
|       setProgressViewEndTarget(boolean scale, int end)       | 设置进度View下拉的结束点，scale 是指设置是否需要放大或者缩小动画 |
|        setColorSchemeColors(@ColorInt int… colors) }         | 设置进度View的组合颜色，在手指上下滑时使用第一个颜色，在刷新中，会一个个颜色进行切换 |
|            setDistanceToTriggerSync(int distance)            |                      设置触发刷新的距离                      |
| setOnChildScrollUpCallback(@Nullable OnChildScrollUpCallback callback) | 如果child是自己自定义的view，可以通过这个回调，告诉swipeRefreshLayoutchild是否可以滑动 |

##### **使用步骤：**

1.建立依赖

```java
dependencies {
    implementation "androidx.swiperefreshlayout:swiperefreshlayout:1.0.0"
   
}
```

2.在xml文件中添加相关代码，并将要刷新的部分放入swiperefreshlayout中

```java
 <androidx.swiperefreshlayout.widget.SwipeRefreshLayout
        android:id="@+id/swipeRefresh"
        android:layout_width="match_parent"
        android:layout_height="538dp"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintEnd_toEndOf="parent"
        >
        --------------------------------------------------------------
            //要刷新的内容
                <androidx.recyclerview.widget.RecyclerView
            android:id="@+id/recy_devices"
            android:layout_width="377dp"
            android:layout_height="538dp"
            android:layout_marginEnd="4dp"
            android:layout_marginBottom="4dp"
             />
         --------------------------------------------------------------
                
    </androidx.swiperefreshlayout.widget.SwipeRefreshLayout>

```

3.在MainActivity.class中实例化并添加监听



```java
//设置进度View样式的大小，只有两个值DEFAULT和LARGE
refreshLayout.setSize(mSetSizeBean.size);
//设置进度View下拉的起始点和结束点，scale 是指设置是否需要放大或者缩小动画
refreshLayout.setProgressViewOffset(true, -0, 100);
//设置进度View下拉的结束点，scale 是指设置是否需要放大或者缩小动画
refreshLayout.setProgressViewEndTarget(true, 180);
//设置进度View的组合颜色，在手指上下滑时使用第一个颜色，在刷新中，会一个个颜色进行切换
refreshLayout.setColorSchemeColors(Color.BLACK, Color.GREEN, Color.RED, Color.YELLOW, Color.BLUE);

//设置触发刷新的距离
refreshLayout.setDistanceToTriggerSync(200);
//如果child是自己自定义的view，可以通过这个回调，告诉mSwipeRefreshLayoutchild是否可以滑动
refreshLayout.setOnChildScrollUpCallback(null);

refreshLayout.setOnRefreshListener(new SwipeRefreshLayout.OnRefreshListener() {
            @Override
            public void onRefresh() {
                //模拟网络请求需要3000毫秒，请求完成，设置setRefreshing 为false，停止刷新
                new Handler().postDelayed(new Runnable() {
                    @Override
                    public void run() {
                        
                        .......期间要执行的代码
                        refreshLayout.setRefreshing(false);
                    }
                }, 3000);
            }
        });

```



一个例子

```java
SwipeRefreshLayout swipeRefreshLayout=findViewById(R.id.swipeRefresh);
swipeRefreshLayout.setOnRefreshListener(new SwipeRefreshLayout.OnRefreshListener() {
            @Override
            public void onRefresh() {
                new Thread(new Runnable() {
                    @Override
                    public void run() {
                        try {
                            Thread.sleep(2000);//延时2000ms执行下面的代码
                        } catch (InterruptedException e) {
                            e.printStackTrace();
                        }
                        
                        //UI线程，可以改变刷新后显示的内容
                        runOnUiThread(new Runnable() {
                            @Override
                            public void run() {
                                deviceList.clear();
                                devicelist= LitePal.order("source_command desc").where("flag = ? and isUpdate = ?","0","1").find(Device.class);
                                initContent();
                                RecyclerView recyclerView = (RecyclerView) findViewById(R.id.recy_devices);
                                LinearLayoutManager linearLayout = new LinearLayoutManager(FindDevices.this);
                                recyclerView.setLayoutManager(linearLayout);
                                FindDeviceAdapter findDeviceAdapter = new FindDeviceAdapter(deviceList);
                                recyclerView.setAdapter(findDeviceAdapter);
                                findDeviceAdapter.notifyDataSetChanged();
                                swipeRefreshLayout.setRefreshing(false);
                            }
                        });
                    }
                }).start();
            }
        });
```



### TextView

##### **样式：**

<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202303182106269.png" alt="image-20230318210626213" style="zoom:67%;" />

##### **基本属性：**



> + android: id: 为TextView设置一个组件id，根据这个id我们可以在Java代码中通过findViewById()方法获取到该对象，然后进行相关属性的设置及操作。 
> + android:layout_width：组件的宽度，一般写："wrap_content"或者"match_parent(fill_parent)"。"wrap_content"：包含内容，意思是内容有多少该组件的宽度就有多少；"match_parent"：匹配父控件，意思是上一个控件的宽度有多少该控件的宽度就有多少；也可以自定义大小，比如设置成200dp。
> + android:layout_height：组件的高度，和上面的layout_width的设置一样，也是"wrap_content"或者是"match_parent"。
> + android:text：设置显示的文本内容，一般我们是把字符串写到string.xml文件中，然后通过@String/xxx取得对应的字符串内容，当然也可以直接写到
> + android:text:""里面，但是一般不建议这么写。写到string.xml文件中的好处就是方便我们更改文字，比如我们的项目有很多相同的文字但是后来我们的项目发布到外国去了，需要翻译成英文的，如果我们直接在这个text中写那么需要我们把整个.xml布局文件中的文字一个一个的更改过来。比如我们的软件各个界面里有很多“关注”，如果直接写在android:text:""里面，我们需要把每个“关注”改成"attention"，如果我们将这个“关注”写在string.xml文件中，我们只需要将string.xml中的   <string name="attention">关注</string>  改为 <string name="attention">attention</string> 就可以将各个界面的“关注”全部改成“attention”了。
> + android:textColor：设置字体颜色，同上，通过colors.xml资源来引用。
> + android:textStyle：设置字体风格，三个可选值："normal"(无效果)，"bold"(加粗)，"italic"(斜体)。可以使用"|"设置多个样式，比如
> + android:textStyle="italic|bold"将文字变为斜体并且加粗。
> + android:textSize：字体大小，单位一般是用sp！
> + android:background：控件的背景颜色，可以理解为填充整个控件的颜色，也可以是图片。
> + android:gravity：设置控件中内容的对齐方向。注意如果要用gravity属性，此组件的layout_width和layout_height不能设置为wrap_content。此时设置的gravity属性没有效果，因为组件包裹着内容，无论设置什么，也都不能有改变。

**例子：**

string.xml文件：

```java
<resources>
    <string name="app_name">TextViewTest</string>
    <string name="hello">大家好！我是ACfun!</string>
</resources>
```

colors.xml文件：

```java
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <color name="colorPrimary">#6200EE</color>
    <color name="colorPrimaryDark">#3700B3</color>
    <color name="colorAccent">#03DAC5</color>
    <color name="red">#FF0000</color>
    <color name="yellow">#FFFF00</color>
</resources>
```

```java
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:context=".MainActivity">
 
    <TextView
        android:id="@+id/tv_message"
        android:layout_width="match_parent"
        android:layout_height="300dp"
        android:text="@string/hello"
        android:textColor="@color/red"
        android:textStyle="italic|bold"
        android:textSize="30sp"
        android:background="@color/yellow"
        android:gravity="center"/>
</LinearLayout>
```

<img src="https://img-blog.csdnimg.cn/20200413162556197.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNTc1NTA3,size_16,color_FFFFFF,t_70" alt="img" style="zoom:50%;" />

**第一个图的代码：**

```java
    <LinearLayout
            android:id="@+id/linearLayout"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="20dp"
            android:orientation="vertical">

            <TextView
                android:id="@+id/show_content"
                android:layout_width="match_parent"
                android:layout_height="54dp"
                android:ellipsize="end"
                android:gravity="bottom"
                android:maxLines="1"
                android:text="6666"
                android:textColor="@color/black"
                android:textSize="30dp"
                android:textStyle="bold" />

            <TextView
                android:id="@+id/textView5"
                android:layout_width="match_parent"
                android:layout_height="4dp"
                android:background="@color/black" />

        </LinearLayout>
```

homebackground.xml

```java
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
    <stroke android:color="@color/black" android:width="0dp"/>
    <corners android:radius="18dp"></corners>
    <size android:width="370dp" android:height="80dp"/>
    <solid android:color="#9AEDF8"/>
</shape>
```

##### **其他属性**

> + android:maxLines：文本的最大行数，如果超过这个最大行数文本将不会显示
> + android:minLines：文本的最小行数，如果超过了这个行数文本将自动换行到下一行继续显示
> + android:ellipsize：当字符内容过长无法全部显示时可以用省略号来代替未显示的字符。有5个可选项"start":省略号在开头；"middle":省略号在中间；"end":省略号在结尾；"marquee"：跑马灯效果；"none"：没有效果。注意：1、需要设置循环的次数，这里使用
> + android:marqueeRepeatLimit="marquee_forever"设置为永久循环。2、实现跑马灯，必须让该控件获得焦点，使用：android:focusable="true"     
> + android:focusableInTouchMode="true"两条语句实现让该控件获得焦点。如果你用的AndroidStudio自带的模拟器，如果你的的api小于26需要加上
> + android:clickable="true"语句，点一下那一行文字才可以实现跑马灯的效果。如果是用的手机则不加第三句也可以，会自动跑起来。
> + android:singleLine： 将文字是否单行显示，如果是“true”则设置为单行显示，“false”则不为单行显示。
> + android:layout_marginTop：当前组件距离其父组件在上方向上的边距，单位为dp。  同样还有左右边距等
> + <u>android:drawableEnd="@drawable/enroll_next"：TextView末端的icon</u>

### Snackbar

##### **特征：**

+ Snackbar 会在超时或者用户在屏幕其他地方触摸之后自动消失
+ 可以在屏幕上滑动关闭
+ 出现时不会阻碍用户在屏幕上的输入
+ 屏幕上同时最多只能显示一个 Snackbar
+ 可以在 Snackbar 中添加一个按钮，处理用户点击事件
+ Snackbar 一般需要 CoordinatorLayout 来作为父容器，CoordinatorLayout 保证 Snackbar 可以右滑退出

##### **常用API：**

|                      **方法**                       |                           **介绍**                           |
| :-------------------------------------------------: | :----------------------------------------------------------: |
|  make(View view, CharSequence text, int duration)   |                   创建 SnackBar 以显示消息                   |
| setAction(int resId, View.OnClickListener listener) |                     设置要在此显示的动作                     |
|      setActionTextColor(ColorStateList colors)      |                    设置指定操作的文本颜色                    |
|            setBackgroundTint(int color)             |                 设置背景 Drawable 的色调颜色                 |
|       setCallback(Snackbar.Callback callback)       |                         添加回调方法                         |
|                       show()                        |                        显示 SnackBar                         |
|                      dismiss()                      |                        隐藏 Snackbar                         |
|                    getContext()                     |                  获取父布局所使用的 Context                  |
|                      isShown()                      |                判断当前 Snackbar 是否正在显示                |
|                  isShownOrQueued()                  |      判断当前 Snackbar 是否正在显示或者已经添加到队列里      |
|              setDuration(int duration)              |                         设置消失时间                         |
|                      getView()                      | Snackbar 所对应的 SnackbarBaseLayout，自定义 Sanckbar 时需要使用 |

##### 使用：

**`1.Snackbar.make(view, message, duration).show();`**

**参数：**

+ view：Snacker 要设置一个 View,Snacker 就显示在该 View 上面
+ message：Snacker 左边显示是文字内容
+ duration：Snacker 显示的时间，
+ Snackbar.LENGTH_SHORT// 短时间显示，然后自动取消
+ Snackbar.LENGTH_LONG// 长时间显示，然后自动取消
+ Snackbar.LENGTH_INDEFINITE// 不消失显示，除非手动取消
+ show()：最后 Snaker 要加上这个才会显示

```java
Snackbar.make(view, "提示：您有新消息", Snackbar.LENGTH_SHORT).show();
```

<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202304211327879.gif" alt="aHR0cHM6Ly9pbWdrci5jbi1iai51ZmlsZW9zLmNvbS8yMWIxYmMwYy1jOTg1LTQ1ZjQtYTE2My0yYTBlM2JhMDQzMDguZ2lm" style="zoom:80%;" />

**2.设置 SnackBar 文本颜色和背景颜色**

Snackbar 的官方 API 只提供了 setActionTextColor()这个方法修改 Action 的文字颜色。在源码中我们看到 Snackbar 中定义了一个继承自 LinearLayout 的内部类 SnackbarLayout，Snackbar 的样子就是由这个 SnackbarLayout 实现的。

+ 通过 findViewById(R.id.snackbar_text)找到 SnackBar 的 id，然后强转 TextView，调用 setTextColor()方法就可以完成字体颜色设置。

+ snackbar.getView()获取到 SnackBar 背景布局 View，调用 setBackgroundColor 完成背景颜色设置。

```java
Snackbar snackbar = Snackbar.make(view, "提示：您有新消息", Snackbar.LENGTH_SHORT);
View snackbarView = snackbar.getView();
if (snackbarView != null) {
    snackbarView.setBackgroundColor(Color.GRAY);
    ((TextView) snackbarView.findViewById(R.id.snackbar_text)).setTextColor(Color.YELLOW);
}
snackbar.show();
```



<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202304211329625.gif" alt="aHR0cHM6Ly9pbWdrci5jbi1iai51ZmlsZW9zLmNvbS8xOWIxZTI4ZC0zZjBkLTQ3MmEtOGE2OC0zZWYwM2EyOGExYTUuZ2lm" style="zoom:80%;" />



**3、设置 setAction**

**`setAction(CharSequence text, final OnClickListener listener)`**

参数：

- text 设置 SnackBar 右侧文本
- listener 设置右侧文本点击事件

```java
Snackbar.make(view, "提示：您有新消息", Snackbar.LENGTH_SHORT)
      //设置Action，右边一个按钮
      .setAction("确定", click -> {
          Toast.makeText(SnackBarActivity.this,"Open Message",Toast.LENGTH_SHORT).show();
      }).show();
```

<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202304211330316.gif" alt="aHR0cHM6Ly9pbWdrci5jbi1iai51ZmlsZW9zLmNvbS9jZDhiMDI1Zi1kMzE4LTRiNzMtYWQyZC1iNGNjNjM4YjMwYTkuZ2lm" style="zoom:80%;" />



**4、设置 setAction 文本颜色**
**`setActionTextColor(int color)`**

参数：

+ color：设置文本字体颜色

```java
+ Snackbar.make(view, "提示：您有新消息", Snackbar.LENGTH_SHORT)
        //设置Action，右边一个按钮
        .setAction("确定", click -> {
        })
        //设置Action文本颜色
        .setActionTextColor(Color.YELLOW)
        .show();
```

<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202304211330716.gif" alt="aHR0cHM6Ly9pbWdrci5jbi1iai51ZmlsZW9zLmNvbS9hMWRmOTMyNS0wYTNlLTQyYzYtYTlkOC0xNDAyYzVmYmY5NWYuZ2lm" style="zoom:80%;" />



**5、设置 SnackBar 监听事件**

**`addCallback(BaseTransientBottomBar.BaseCallback<B> callback)`**

SnackBar 的回调中有个 onshow()和 onDismissed()两个重要的方法。

- 一个是显示的时候调用
- 一个是消失的时候调用

```java
Snackbar.make(view, "提示：您有新消息", Snackbar.LENGTH_SHORT)
      //设置Action，右边一个按钮
      .setAction("确定", click -> {
      })
      //添加SnackBar监听事件
      .addCallback(new Snackbar.Callback() {

          @Override
          public void onShown(Snackbar sb) {
              super.onShown(sb);
              Toast.makeText(SnackBarActivity.this,"onShown",Toast.LENGTH_SHORT).show();
          }

          @Override
          public void onDismissed(Snackbar transientBottomBar, int event) {
              super.onDismissed(transientBottomBar, event);
              Toast.makeText(SnackBarActivity.this,"onDismissed",Toast.LENGTH_SHORT).show();
          }
      })
      .show();
```

<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202304211331162.gif" alt="aHR0cHM6Ly9pbWdrci5jbi1iai51ZmlsZW9zLmNvbS81MWZkZGEwMy1iOGU4LTRiYzItOTBkNy0zY2JmMTFiOWEzZWIuZ2lm" style="zoom:80%;" />



**onDismissed()方法中的 event 事件有 5 种：**

1. 滑动消失的时候调用

public static final int DISMISS_EVENT_SWIPE=0;

2. 点击 Action 消失的时候调用

public static final intDISMISS_EVENT_ACTION=1;

3. 超时消失的时候调用

public static final intDISMISS_EVENT_TIMEOUT=2;

4. 手动调用 dismiss()方法时调用

public static final intDISMISS_EVENT_MANUAL=3;

5. 一个新的 SnackBar 出现的时候调用

public static final intDISMISS_EVENT_CONSECUTIVE=4;



##### Snackbar 与 Dialog 和 Toast 的比较：

**Dialog**
**模态对话框。**也就说，此刻该对话框中的内容获取了焦点，想要操作对话框以外的功能，必须先对该对话框进行响应。
**应用场景：**对于删除确认、版本更新等重要性提示信息，需要用户做出选择的情况下，使用 Dialog。

**Toast**
**非模态提示框。**也就说提示框的显示并不影响我们对其他地方的操作，Toast 无法手动控制隐藏，需要设置 Toast 的显示时长，一旦显示时间结束，Toast 会自动消失。如果多次点击并显示 Toast，就会出现 Toast 重复创建并显示，给用户造成一种 Toast 长时间不隐藏的幻觉。
**应用场景：**对于无网络提示、删除成功、发布操作完成等这类不重要的提示性信息，使用 Toast。

**Snackbar**
Snackbar 和 Toast 比较相似，但是用途更加广泛，并且它是可以和用户进行交互的。Snackbar 使用一个动画效果从屏幕的底部弹出来，过一段时间后也会自动消失。
**应用场景：**删除操作时，弹出 Snackbar 用于确认删除操作；消息发送失败时，弹出 Snackbar，用于重新发送操作；当然重要的是与 MD 组件相结合，用户体验效果更佳。



### ViewPager 

#####  <span style="background-color:#00FFFF;"><b>使用方法：</b></span>

==总步骤：==

> 1.写布局文件，添加一个viewpager控件
>
> 2.在Activity中获取实例
>
> 3.创建一个数据-视图适配器adapter
>
> 4.创建一个myViewPagerAdapter实例
>
> 5.初始化数据
>
> 6.将数据添加到适配器中
>
> 7.布局与适配器绑定
>
> 8.addOnPageChangeListener()添加事件响应



**1.在布局文件中添加`ViewPager`**

```xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity">

    <androidx.viewpager.widget.ViewPager；
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:id="@+id/viewpager1">
    </androidx.viewpager.widget.ViewPager>
</androidx.constraintlayout.widget.ConstraintLayout>

```

**2.在`MainActivity`中获取`ViewPager`实例**

```yacas
viewPager=findViewById(R.id.viewpager1);
```

**3.创建适配器`MyViewPagerAdapter`继承自`PagerAdaptor`**

**步骤：**

+ 1.继承自`PagerAdapter`抽象类
+ 2.重写抽象类中的方法`getCount()`和`isViewFromObject()`
+ 3.ctrl+o重写 生成:`instantiateItem()` 销毁:`destroyItem()`
+ 4.用一个`imageViewList`数组来存储图片数据,并创建构造函数初始化
+ 5.`getCount()`方法返回图片的数量
+ 6.`instantiateItem()`将图片数据加载到viewpager页面,返回加载的这个图片
+ 7.`destroyItem()`将图片从viewpager中移除

+ **重写getCount、isViewFromObject、instantiateItem和destroyItem四个方法。**

![image-20230430173431150](https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202304301734387.png)

```java
package com.example.viewpager;

import android.view.View;
import android.view.ViewGroup;
import android.widget.ImageView;

import androidx.annotation.NonNull;
import androidx.viewpager.widget.PagerAdapter;

import java.util.ArrayList;
import java.util.List;

public class MyViewPagerAdapter extends PagerAdapter {
    List<ImageView> imageViewList=new ArrayList<>();

    public MyViewPagerAdapter(List<ImageView> imageViewList) {
        this.imageViewList=imageViewList;
    }

    @Override
    public int getCount() {
        return imageViewList.size();
    }


    @Override
    public boolean isViewFromObject(@NonNull View view, @NonNull Object object) {
        return view==object;
    }
    
    @NonNull
    @Override
    public Object instantiateItem(@NonNull ViewGroup container, int position) {
        ImageView imageView=imageViewList.get(position);
        container.addView(imageView);
        return imageView;
    }

    @Override
    public void destroyItem(@NonNull ViewGroup container, int position, @NonNull Object object) {
        container.removeView((View) object);
    }
}
```

**5.初始化数据，布局与适配器绑定**

```java
public class MainActivity extends AppCompatActivity {

............

//        初始化数据
        initData();
//        将数据添加到适配器中
        myViewPagerAdapter=new MyViewPagerAdapter(imageViewList);
//        布局与适配器绑定
        viewPager.setAdapter(myViewPagerAdapter);
        
    
        }

private void initData() {
        ImageView imageView1=new ImageView(this);
        imageView1.setImageResource(R.drawable.image1);
        imageView1.setScaleType(ImageView.ScaleType.FIT_XY);

        ImageView imageView2=new ImageView(this);
        imageView2.setImageResource(R.drawable.image2);
        imageView2.setScaleType(ImageView.ScaleType.FIT_XY);

        ImageView imageView3=new ImageView(this);
        imageView3.setImageResource(R.drawable.image3);
        imageView3.setScaleType(ImageView.ScaleType.FIT_XY);


        imageViewList=new ArrayList<>();
        imageViewList.add(imageView1);
        imageViewList.add(imageView2);
        imageViewList.add(imageView3);
    }
```

**6.添加点击事件**

```java
 viewPager.addOnPageChangeListener(new ViewPager.OnPageChangeListener() {
            @Override
            public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {

            }

            @Override
            public void onPageSelected(int position) {
                Toast.makeText(MainActivity.this,"你先中了第"+position+"页",Toast.LENGTH_SHORT).show();
            }

            @Override
            public void onPageScrollStateChanged(int state) {

            }
        });
```

**总代码：**

```java
package com.example.viewpager;

import androidx.appcompat.app.AppCompatActivity;
import androidx.viewpager.widget.ViewPager;

import android.media.Image;
import android.os.Bundle;
import android.widget.ImageView;
import android.widget.Toast;



import java.util.ArrayList;
import java.util.List;

public class MainActivity extends AppCompatActivity {

    /*
     * 1.写布局文件，添加一个viewpager控件
     * 2.在Activity中获取实例
     * 3.创建一个数据-视图适配器adapter
     * 4.创建一个myViewPagerAdapter实例
     * 5.初始化数据
     * 6.将数据添加到适配器中
     * 7.布局与适配器绑定
     * 8.addOnPageChangeListener()添加事件响应
     *
     */
    private ViewPager viewPager;
    private MyViewPagerAdapter myViewPagerAdapter;
    private List<ImageView> imageViewList;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
//        获取实例
        viewPager=findViewById(R.id.viewpager1);
//        初始化数据
        initData();
//        将数据添加到适配器中
        myViewPagerAdapter=new MyViewPagerAdapter(imageViewList);
//        布局与适配器绑定
        viewPager.setAdapter(myViewPagerAdapter);
//        添加事件响应
        viewPager.addOnPageChangeListener(new ViewPager.OnPageChangeListener() {
            @Override
            public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {

            }

            @Override
            public void onPageSelected(int position) {
                Toast.makeText(MainActivity.this,"你先中了第"+position+"页",Toast.LENGTH_SHORT).show();
            }

            @Override
            public void onPageScrollStateChanged(int state) {

            }
        });


    }

    private void initData() {
        ImageView imageView1=new ImageView(this);
        imageView1.setImageResource(R.drawable.image1);
        imageView1.setScaleType(ImageView.ScaleType.FIT_XY);

        ImageView imageView2=new ImageView(this);
        imageView2.setImageResource(R.drawable.image2);
        imageView2.setScaleType(ImageView.ScaleType.FIT_XY);

        ImageView imageView3=new ImageView(this);
        imageView3.setImageResource(R.drawable.image3);
        imageView3.setScaleType(ImageView.ScaleType.FIT_XY);


        imageViewList=new ArrayList<>();
        imageViewList.add(imageView1);
        imageViewList.add(imageView2);
        imageViewList.add(imageView3);
    }
}
```

##### <span style="background-color:#a2e043;"><b>结果：</b></span>

<img src="../Downloads/Screenrecording_2023_-original-original.gif" alt="Screenrecording_2023_-original-original" style="zoom: 25%;" />

### ViewPager与Fragment结合实现多页面滑动

<font color="gray"><b>感觉有些类似于RecyclerView，ViewPager是展示的地方</b></font>

##### <span style="background-color:#00FFFF;"><b>使用方法：</b></span>

**FragmentPagerAdapter的用法：**

+ 1.重写getItem() 获取fragment
+ 2.重写getCount() 返回fragment的实例个数



**具体实现：**

+ 1.在activity_main.xml中添加ViewPager
+ 2.获取到viewPager实例
+ 3.创建fragment页面（初始化数据）
+ 4.创建一个自定义的适配器myFragmentAdapter
+ 5.初始化数据
+ 6.获取MyFragmentAdapter实例，需要传入两个参数
+ 7.将ViewPager和myFragmentAdapter适配器绑定
+ 8.实现事件监听，和上一个demo一样

**1.在activity_main.xml中添加ViewPager**

![image-20230430215046929](https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202304302150107.png)

**2.在MainActivity中获取到viewPager实例**

![image-20230430215135536](https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202304302151610.png)

**3.创建Fragment页面**

> 因为我们等会要创建多个MyFragment对象，填充到ViewPager中，因此通过一个文本控件来区别不同的fragment页面
>
> + 1.声明文本控件变量
> + 2.外部通过newInstance实例化fragment,并带入外界传入的参数。参数存在Bundle对象中
> + 3.onCreate取出存在Bundle中的数据
> + 4.onViewCreated通过view找到布局中的文本控件并设置为外界传入的参数

```java
public class MyFragment extends Fragment {
    private static final String ARG_PARAM1 = "param1";
    private String mParam;
    
    //声明文本控件变量
    private TextView textView;

    //外部通过newInstance实例化fragment,并带入外界传入的参数。参数存在Bundle对象中
    @NonNull
    public static MyFragment newInstance(String name) {
        MyFragment myFragment = new MyFragment();
        Bundle args = new Bundle();
        args.putString(ARG_PARAM1, name);
        myFragment.setArguments(args);
        return myFragment;
    }

    //onCreate取出存在Bundle中的数据
    @Override
    public void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if (getArguments()!=null) {
            mParam=getArguments().getString(ARG_PARAM1);
        }
    }

    @Nullable
    @Override
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        return inflater.inflate(R.layout.fragment_my,container,false);
    }

    //onViewCreated通过view找到布局中的文本控件并设置为外界传入的参数
    @Override
    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {
        super.onViewCreated(view, savedInstanceState);
        textView=view.findViewById(R.id.textView);
        textView.setText(mParam);

    }
}
```

**4.创建一个自定义的适配器myFragmentAdapter**



+ 1.自定义一个适配器类MyFragmentVPAdapter继承自FragmentPagerAdapter
+ 2.重写getItem()和getCount()方法
+ 3.在构造方法中初始化数据
+ 4.getItem返回当前的fragment
+ 5.getCount返回fragment的数量

```java
public class MyFragmentAdaptor extends FragmentPagerAdapter {
    private List<Fragment> fragmentList;
    public MyFragmentAdaptor(@NonNull FragmentManager fm,List<Fragment> fragmentList) {
        super(fm);
        this.fragmentList=fragmentList;
    }

    @NonNull
    @Override
    public Fragment getItem(int position) {
        return fragmentList==null?null:fragmentList.get(position);
    }

    @Override
    public int getCount() {
        return fragmentList==null?null:fragmentList.size();
    }
}
```

**5.在MainActivity中初始化数据并绑定适配器**

```java
public class MainActivity extends AppCompatActivity {
    private ViewPager viewPager;
    private List<Fragment> fragmentList=new ArrayList<>();
    private MyFragmentAdaptor myFragmentAdaptor;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        viewPager=findViewById(R.id.viewPager);
        //        初始化数据
        initData();
//        获取MyFragmentVPAdapter实例，需要传入两个参数
        myFragmentAdaptor=new MyFragmentAdaptor(getSupportFragmentManager(),fragmentList);
//        将ViewPager和myFragmentVPAdapter适配器绑定
        viewPager.setAdapter(myFragmentAdaptor);
//        实现事件监听，和上一个demo一样

    }
    private void initData() {
        fragmentList=new ArrayList<>();
        MyFragment fragment1=MyFragment.newInstance("这是第1个fragment");
        MyFragment fragment2=MyFragment.newInstance("这是第2个fragment");
        MyFragment fragment3=MyFragment.newInstance("这是第3个fragment");
        MyFragment fragment4=MyFragment.newInstance("这是第4个fragment");
        MyFragment fragment5=MyFragment.newInstance("这是第5个fragment");
        fragmentList.add(fragment1);
        fragmentList.add(fragment2);
        fragmentList.add(fragment3);
        fragmentList.add(fragment4);
        fragmentList.add(fragment5);

    }
}
```

**6.添加滑动监听事件**

```jaba
        viewPager.addOnPageChangeListener(new ViewPager.OnPageChangeListener() {
            @Override
            public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {

            }

            @Override
            public void onPageSelected(int position) {
              Snackbar.make(viewPager,"这是第"+(position+1)+"个fragment",Snackbar.LENGTH_SHORT).show();
            }

            @Override
            public void onPageScrollStateChanged(int state) {

            }
        });
```

##### <span style="background-color:#a2e043;"><b>结果：</b></span>

<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202304302216991.gif" alt="device-2023-04-30-22_-original-original" style="zoom:25%;" />

### ViewPager+Fragment+BottomNav

> 这个感觉原理挺简单，懒得整理了，就是滑动Page后改变BottomNavigationView的选择的按钮







### ImmersionBar——沉浸式状态栏

##### **样式：**

<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305142039460.png" alt="image-20230514203939396" style="zoom: 67%;" />



**相关属性：**

官方文档：[ImmersionBar](https://github.com/gyf-dev/ImmersionBar)

依赖：

```java
// 基础依赖包，必须要依赖
implementation 'com.geyifeng.immersionbar:immersionbar:3.2.2'
// kotlin扩展（可选）
implementation 'com.geyifeng.immersionbar:immersionbar-ktx:3.2.2'
// fragment快速实现（可选）已废弃
implementation 'com.geyifeng.immersionbar:immersionbar-components:3.2.2'
```

```java
 ImmersionBar.with(this)
             .transparentStatusBar()  //透明状态栏，不写默认透明色
             .transparentNavigationBar()  //透明导航栏，不写默认黑色(设置此方法，fullScreen()方法自动为true)
             .transparentBar()             //透明状态栏和导航栏，不写默认状态栏为透明色，导航栏为黑色（设置此方法，fullScreen()方法自动为true）
             .statusBarColor(R.color.colorPrimary)     //状态栏颜色，不写默认透明色
             .navigationBarColor(R.color.colorPrimary) //导航栏颜色，不写默认黑色
             .barColor(R.color.colorPrimary)  //同时自定义状态栏和导航栏颜色，不写默认状态栏为透明色，导航栏为黑色
             .statusBarAlpha(0.3f)  //状态栏透明度，不写默认0.0f
             .navigationBarAlpha(0.4f)  //导航栏透明度，不写默认0.0F
             .barAlpha(0.3f)  //状态栏和导航栏透明度，不写默认0.0f
             .statusBarDarkFont(true)   //状态栏字体是深色，不写默认为亮色
             .navigationBarDarkIcon(true) //导航栏图标是深色，不写默认为亮色
             .autoDarkModeEnable(true) //自动状态栏字体和导航栏图标变色，必须指定状态栏颜色和导航栏颜色才可以自动变色哦
             .autoStatusBarDarkModeEnable(true,0.2f) //自动状态栏字体变色，必须指定状态栏颜色才可以自动变色哦
             .autoNavigationBarDarkModeEnable(true,0.2f) //自动导航栏图标变色，必须指定导航栏颜色才可以自动变色哦
             .flymeOSStatusBarFontColor(R.color.btn3)  //修改flyme OS状态栏字体颜色
             .fullScreen(true)      //有导航栏的情况下，activity全屏显示，也就是activity最下面被导航栏覆盖，不写默认非全屏
             .hideBar(BarHide.FLAG_HIDE_BAR)  //隐藏状态栏或导航栏或两者，不写默认不隐藏
             .addViewSupportTransformColor(toolbar)  //设置支持view变色，可以添加多个view，不指定颜色，默认和状态栏同色，还有两个重载方法
             .titleBar(view)    //解决状态栏和布局重叠问题，任选其一
             .titleBarMarginTop(view)     //解决状态栏和布局重叠问题，任选其一
             .statusBarView(view)  //解决状态栏和布局重叠问题，任选其一
             .fitsSystemWindows(true)    //解决状态栏和布局重叠问题，任选其一，默认为false，当为true时一定要指定statusBarColor()，不然状态栏为透明色，还有一些重载方法
             .supportActionBar(true) //支持ActionBar使用
             .statusBarColorTransform(R.color.orange)  //状态栏变色后的颜色
             .navigationBarColorTransform(R.color.orange) //导航栏变色后的颜色
             .barColorTransform(R.color.orange)  //状态栏和导航栏变色后的颜色
             .removeSupportView(toolbar)  //移除指定view支持
             .removeSupportAllView() //移除全部view支持
             .navigationBarEnable(true)   //是否可以修改导航栏颜色，默认为true
             .navigationBarWithKitkatEnable(true)  //是否可以修改安卓4.4和emui3.x手机导航栏颜色，默认为true
             .navigationBarWithEMUI3Enable(true) //是否可以修改emui3.x手机导航栏颜色，默认为true
             .keyboardEnable(true)  //解决软键盘与底部输入框冲突问题，默认为false，还有一个重载方法，可以指定软键盘mode
             .keyboardMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE)  //单独指定软键盘模式
             .setOnKeyboardListener(new OnKeyboardListener() {    //软键盘监听回调，keyboardEnable为true才会回调此方法
                   @Override
                   public void onKeyboardChange(boolean isPopup, int keyboardHeight) {
                       LogUtils.e(isPopup);  //isPopup为true，软键盘弹出，为false，软键盘关闭
                   }
              })
             .setOnNavigationBarListener(onNavigationBarListener) //导航栏显示隐藏监听，目前只支持华为和小米手机
             .setOnBarListener(OnBarListener) //第一次调用和横竖屏切换都会触发，可以用来做刘海屏遮挡布局控件的问题
             .addTag("tag")  //给以上设置的参数打标记
             .getTag("tag")  //根据tag获得沉浸式参数
             .reset()  //重置所以沉浸式参数
             .init();  //必须调用方可应用以上所配置的参数
```

##### 在Activity中实现沉浸式

- java用法

  ```java
   ImmersionBar.with(this).init();
  ```

- kotlin用法

  ```kotlin
   immersionBar {
       statusBarColor(R.color.colorPrimary) 
       navigationBarColor(R.color.colorPrimary)
   }
  ```

##### 在Fragment中实现沉浸式

- 第一种，fragment如果配合viewpager2使用的话，并且使用了Behavior指定了BEHAVIOR_RESUME_ONLY_CURRENT_FRAGMENT，直接在fragment的onResume里直接实现沉浸式
- 第二种，当使用`show()`和`hide()`来控制Fragment显示隐藏的时候，直接在fragment的`onResume`与`onHiddenChanged`（参数hidden为false）方法里实现沉浸式

##### 在Activity使用ImmersionBar

- 第一种，当结合viewpager2使用的时候，请使用viewpager2的registerOnPageChangeCallback的方法监听沉浸式
- 第二种，当结合viewpager使用的时候，请使用viewpager的addOnPageChangeListener的方法监听沉浸式，参考demo中[FragmentThreeActivity](https://github.com/gyf-dev/ImmersionBar/tree/master/immersionbar-sample/src/main/java/com/gyf/immersionbar/sample/activity/FragmentThreeActivity.java)这个类
- 第三种，当使用show()和hide()来控制Fragment显示隐藏的时候，请在tab切换的时候使用ImmersionBar，参考demo中[FragmentFourActivity](https://github.com/gyf-dev/ImmersionBar/tree/master/immersionbar-sample/src/main/java/com/gyf/immersionbar/sample/activity/FragmentFourActivity.java)这个类

##### 使用Fragment第三方框架[Fragmentation](https://github.com/YoKeyword/Fragmentation)实现沉浸式

- 参考demo中[FragmentFiveActivity](https://github.com/gyf-dev/ImmersionBar/blob/master/immersionbar-sample/src/main/java/com/gyf/immersionbar/sample/activity/FragmentFiveActivity.java)和[BaseFiveFragment](https://github.com/gyf-dev/ImmersionBar/tree/master/immersionbar-sample/src/main/java/com/gyf/immersionbar/sample/fragment/five/BaseFiveFragment.java)这个类

##### 在Dialog中实现沉浸式，具体实现参考demo

- ①结合dialogFragment使用，可以参考demo中的[BaseDialogFragment](https://github.com/gyf-dev/ImmersionBar/tree/master/immersionbar-sample/src/main/java/com/gyf/immersionbar/sample/fragment/dialog/BaseDialogFragment.java)这个类

  ```java
      ImmersionBar.with(this).init();
  ```

- ②其他dialog，关闭dialog的时候必须调用销毁方法

  ```java
      ImmersionBar.with(this, dialog).init();
  ```

  销毁方法：

  - java中

  ```java
      ImmersionBar.destroy(this, dialog);
  ```

  - kotlin中

  ```java
      destroyImmersionBar(dialog)
  ```

<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305142031963.gif" alt="Screenshot_dialog" style="zoom: 33%;" />

> 官方的demo，不是我想要弄这种图片哈



###   TabLayout

#### 一、基础使用

##### ①设置标题

1.创建`BasicUseActivity.java`和`activity_basic_use.xml`

<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305152220457.png" alt="image-20230515222019215" style="zoom: 80%;" />

2.在`activity_basic_use`中添加`TabLayout`

```css
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".mode1.BasicUseActivity">

    <com.google.android.material.tabs.TabLayout
        android:id="@+id/tab_layout"
        android:layout_marginTop="27dp"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="#FFF" />
</LinearLayout>
```

3.修改`BasicUseActivity`中代码

```java
public class BasicUseActivity extends AppCompatActivity {

    private TabLayout tabLayout;
    /**
     * 标题数组
     */
    private String[] titles = {"one","two","three","four","five"};

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_basic_use);
        ImmersionBar.with(this).statusBarColor(R.color.green).init();
        tabLayout = findViewById(R.id.tab_layout);

        for (String title : titles) {
            //设置标签标题
            tabLayout.addTab(tabLayout.newTab().setText(title));
        }
    }
}
```

<span style="background-color:#a2e043;"><b>结果：</b></span>

<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305152231748.gif" alt="untitled_-original-original" style="zoom:25%;" />

> 演示的时候发现之前设置的内容都是小写，但运行后都变成了大写，要怎么修改成小写呢？
>
> 在你的res → values → styles.xml，修改代码为
>
> ```css
> <?xml version="1.0" encoding="utf-8"?>
> <resources>
>     <!--Tab英文文字小写-->
>     <style name="TabTextAllCapStyle" parent="TextAppearance.Design.Tab">
>         <!--不启用大写-->
>         <item name="textAllCaps">false</item>
>     </style>
> </resources>
> ```
>
> 然后通过
>
> ```css
> 	app:tabTextAppearance="@style/TabTextAllCapStyle"
> ```
>
> 设置到这个控件里面就可以了



![image-20230515224344529](https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305152243731.png)

**点击Tab时大写，不点击的时小写**



在`BasicUseActivity`中添加代码

```java
  		//标签默认选中的tab为大写
        tabLayout.getTabAt(0).setText(titles[0].toUpperCase());
        //标签选中监听
        tabLayout.addOnTabSelectedListener(new TabLayout.OnTabSelectedListener() {
            /**
             * 选中
             * @param tab
             */
            @RequiresApi(api = Build.VERSION_CODES.M)
            @Override
            public void onTabSelected(TabLayout.Tab tab) {
                //大写
                tab.setText(titles[tab.getPosition()].toUpperCase());
            }

            /**
             * 未选中
             * @param tab
             */
            @Override
            public void onTabUnselected(TabLayout.Tab tab) {
                //小写
                tab.setText(titles[tab.getPosition()].toLowerCase());
            }

            /**
             * 重新选中
             * @param tab
             */
            @Override
            public void onTabReselected(TabLayout.Tab tab) {
                //大写
                tab.setText(titles[tab.getPosition()].toUpperCase());
            }
        });
```

##### ②设置图标

**1.添加图标数组**

```java
private Integer[] icons = {R.drawable.img, R.drawable.img_1, R.drawable.img_2,
        R.drawable.img_3, R.drawable.img_4};
```

**2.修改刚才的for循环为**

```java
for (int i = 0;i < titles.length; i++){
    //设置标签标题和图标
    tabLayout.addTab(tabLayout.newTab().setText(titles[i]).setIcon(icons[i]));
}
```



<span style="background-color:#a2e043;"><b>结果：</b></span>

<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305152308553.gif" alt="untitled_-original-original (1)" style="zoom:25%;" />

##### ③设置下划线

安卓原生的安卓紫实在有点丑，修改一下Tab的字体颜色和下划线颜色，换成原谅绿

```css
        app:tabIndicatorColor="#00FF00"
        app:tabTextColor="#00FF00"
```

<span style="background-color:#a2e043;"><b>结果：</b></span>

<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305192043431.gif" alt="device-2023-05-19-20_-original-original (1)" style="zoom:25%;" />

当然更多实际需求是修改下划线的长度可以随文字大小改变而改变，实现方式很简单：

```css
	app:tabIndicatorFullWidth="false"
```

<span style="background-color:#a2e043;"><b>结果：</b></span>

![image-20230519205412670](https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305192054750.png)

### 二、分类界面

> **TabLayout + ViewPager + Fragment**

效果类似于以下的照片：



![在这里插入图片描述](https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305201353496.webp)

<span style="background-color:#00FFFF;"><b>实现步骤：</b></span>

##### **①创建`ClassificationActivity.java`，并修改相应的activity_classification.xml文件：**

```css
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:context=".mode2.ClassificationActivity">

    <com.google.android.material.tabs.TabLayout
        android:id="@+id/tab_layout"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="47dp"
        android:background="#FFF"
        app:tabIndicatorColor="#00FF00"
        app:tabIndicatorFullWidth="false"
        app:tabMode="scrollable"
        app:tabRippleColor="#00000000"
        app:tabSelectedTextColor="#00FF00"
        app:tabTextColor="#000" />

    <androidx.viewpager.widget.ViewPager
        android:id="@+id/view_pager"
        android:layout_width="match_parent"
        android:layout_height="match_parent"/>
</LinearLayout>
```

##### **②创建Fragment**

![image-20230520175153273](https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305201751718.png)

`InternationalFragment`

```JAVA
public class InternationalFragment extends Fragment {

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        // Inflate the layout for this fragment
        return inflater.inflate(R.layout.fragment_international, container, false);
    }
}
```

`fragment_tv_series.xml`

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center"
    android:orientation="vertical">

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="国际"
        android:textColor="#000"
        android:textSize="24sp" />
</LinearLayout>
```



其余的Fragment的内容跟上面展示的基本一样，不再展示。

##### **③Fragment的适配器**

```java
public class BasicFragmentAdapter extends FragmentPagerAdapter {

    String[] titleArr;
    List<Fragment> fragmentList;
    public BasicFragmentAdapter(@NonNull FragmentManager fm, List<Fragment> list,String[] titleArr){
        super(fm);
        fragmentList=list;
        this.titleArr=titleArr;
    }

    @NonNull
    @Override
    public Fragment getItem(int position) {
        return fragmentList.get(position);
    }

    @Override
    public int getCount() {
        return fragmentList!=null?fragmentList.size():0;
    }

    @Nullable
    @Override
    public CharSequence getPageTitle(int position) {
        return titleArr[position];
    }
   
}
```

④修改`ClassificationActivity`中的代码

```java
public class ClassificationActivity extends AppCompatActivity {

    private TabLayout tabLayout;
    private ViewPager viewPager;
    String[] titleArray = new String[]{"电视剧", "电影", "综艺", "体育", "新闻", "国际"};

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_classification);
        ImmersionBar.with(this).statusBarColor(R.color.green).init();
        tabLayout = findViewById(R.id.tab_layout);
        viewPager = findViewById(R.id.view_pager);

        List<Fragment> fragmentList = new ArrayList<>();
        fragmentList.add(new TVSeriesFragment());
        fragmentList.add(new MovieFragment());
        fragmentList.add(new VarietyShowFragment());
        fragmentList.add(new SportsFragment());
        fragmentList.add(new NewsFragment());
        fragmentList.add(new InternationalFragment());
        BasicFragmentAdapter adapter = new BasicFragmentAdapter(getSupportFragmentManager(), fragmentList, titleArray);
        viewPager.setAdapter(adapter);
        tabLayout.setupWithViewPager(viewPager);
        //将ViewPager与tabLayout关联起来

    }


}
```

<span style="background-color:#a2e043;"><b>结果：</b></span>

<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305201638084.gif" alt="untitled_-original-original (4)" style="zoom:25%;" />



**接下来实现点击后字体变大：**

①新建一个`tab_item.xml`文件

```java
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical">

    <TextView
        android:id="@+id/tv_title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:gravity="center"
        android:textColor="#333333"
        android:textSize="14sp" />

</LinearLayout>
```

②在`ClassificationActivity`中添加以下代码：



```java
/**
 * 初始化TabLayout
 */
private void initTabLayout() {
    for (int i = 0; i < tabLayout.getTabCount(); i++) {
        TabLayout.Tab tab = tabLayout.getTabAt(i);
        if (tab != null) {
            //设置标签视图为  TextView，之后可以通过getCustomView()来获取TextView的ID，进而进行修改
            tab.setCustomView(getTabView(i));
        }
    }

    updateTabText(tabLayout.getTabAt(tabLayout.getSelectedTabPosition()), true);

    tabLayout.addOnTabSelectedListener(new TabLayout.OnTabSelectedListener() {
        @Override
        public void onTabSelected(TabLayout.Tab tab) {
            updateTabText(tab,true);
        }

        @Override
        public void onTabUnselected(TabLayout.Tab tab) {
            updateTabText(tab,false);
        }

        @Override
        public void onTabReselected(TabLayout.Tab tab) {

        }
    });
}

/**
 * 获取TabView
 * @param currentPosition
 * @return
 */
private View getTabView(int currentPosition) {
    View view = LayoutInflater.from(this).inflate(R.layout.tab_item, null);
    TextView textView = view.findViewById(R.id.tv_title);
    textView.setText(titleArray[currentPosition]);
    return view;
}

/**
 * 更新标签文字
 * @param tab
 * @param isSelect
 */
private void updateTabText(TabLayout.Tab tab, boolean isSelect) {
    if (isSelect) {
        //选中文字加大加粗
        TextView tabSelect = tab.getCustomView().findViewById(R.id.tv_title);
        tabSelect.setTextSize(22);
        tabSelect.setTextColor(Color.parseColor("#00FF00"));
        tabSelect.setTypeface(Typeface.defaultFromStyle(Typeface.BOLD));
        tabSelect.setText(tab.getText());
    } else {
        TextView tabUnSelect = tab.getCustomView().findViewById(R.id.tv_title);
        tabUnSelect.setTextSize(14);
        tabUnSelect.setTextColor(Color.BLACK);
        tabUnSelect.setTypeface(Typeface.defaultFromStyle(Typeface.NORMAL));
        tabUnSelect.setText(tab.getText());
    }
}
```

同时添加一行代码：

<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305202214971.png" alt="image-20230520221431648" style="zoom: 80%;" />



<span style="background-color:#a2e043;"><b>结果：</b></span>

<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305202209606.gif" alt="untitled_-original-original (5)" style="zoom:25%;" />



### 三、APP主界面

> **TabLayout+TabItem+ViewPager+Fragment**

①选中图标

**用到的图标：**

![image-20230528201549751](https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305282015833.png)

**创建drawable文件来存放图标：**

![image-20230528201852669](https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305282018708.png)

```css
//app_find.xml
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:drawable="@drawable/img_10" android:state_selected="false"/>
    <item android:drawable="@drawable/img_9" android:state_selected="true"/>
</selector>
```

```css
//app_home
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:drawable="@drawable/img_6" android:state_selected="false"/>
    <item android:drawable="@drawable/img_5" android:state_selected="true"/>
</selector>
```

**修改`activity_home.xml`中的代码：**



```java
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".mode3.HomeActivity">

    <androidx.viewpager.widget.ViewPager
        android:id="@+id/view_pager"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_above="@+id/tab_layout" />

    <com.google.android.material.tabs.TabLayout
        android:id="@+id/tab_layout"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:background="#FFF"
        android:minHeight="?attr/actionBarSize"
        app:tabIndicatorColor="#00000000"
        app:tabRippleColor="#00000000"
        app:tabSelectedTextColor="#1296DB"
        app:tabTextColor="#929299">

        <com.google.android.material.tabs.TabItem
            android:id="@+id/item_home"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:icon="@drawable/app_home"
            android:text="主页" />

        <com.google.android.material.tabs.TabItem
            android:id="@+id/item_search"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:icon="@drawable/app_search"
            android:text="搜索" />

        <com.google.android.material.tabs.TabItem
            android:id="@+id/item_find"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:icon="@drawable/app_find"
            android:text="发现" />

        <com.google.android.material.tabs.TabItem
            android:id="@+id/item_mine"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:icon="@drawable/app_mine"
            android:text="我的" />

    </com.google.android.material.tabs.TabLayout>
</RelativeLayout>
```

  这里对TabLayout控件做了一些修改，设置点击的水波纹为透明、下划线为透明，选中的文字颜色为蓝色，默认是灰色，和刚才创建的四个图标样式文件类似，选中时切换蓝色图片，未选中时灰色图片。

##### ②创建Fragment

```java
package com.example.tablayout.mode3;

import android.os.Bundle;

import androidx.fragment.app.Fragment;

import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

import com.example.tablayout.R;


public class HomeFragment extends Fragment {


    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        // Inflate the layout for this fragment
        return inflater.inflate(R.layout.fragment_home, container, false);
    }
}
```

**对应的`fragment_home.xml`文件:**

```css
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center"
    android:orientation="vertical">

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Home"
        android:textColor="#000"
        android:textSize="24sp" />
</LinearLayout>
```

一共创建四个，内容基本差不多，因此不过多展示了，结构如下：

![image-20230528202939778](https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305282029844.png)

##### ③编码运行

现在四个Fragment和它们的布局都写好了，下面回到`HomeActivity`中，修改代码如下：

```java
package com.example.tablayout.mode3;

import android.os.Bundle;

import androidx.appcompat.app.AppCompatActivity;
import androidx.fragment.app.Fragment;
import androidx.viewpager.widget.ViewPager;

import com.example.tablayout.R;
import com.example.tablayout.mode2.BasicFragmentAdapter;
import com.google.android.material.tabs.TabLayout;
import com.gyf.immersionbar.ImmersionBar;

import java.util.ArrayList;
import java.util.List;

/**
 * @className: HomeActivity
 * @author: LiuKai
 * @description:
 * @date: 2023/5/20
 **/
public class HomeActivity extends AppCompatActivity {

    private TabLayout tabLayout;
    private ViewPager viewPager;

    final String[] titleArray = new String[]{"首页", "搜索", "发现", "我的"};

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_home);
        ImmersionBar.with(this).statusBarColor(R.color.green).init();
        init();
    }

    private void init() {
        tabLayout = findViewById(R.id.tab_layout);
        viewPager = findViewById(R.id.view_pager);

        List<Fragment> fragmentList = new ArrayList<>();
        fragmentList.add(new HomeFragment());
        fragmentList.add(new SearchFragment());
        fragmentList.add(new FindFragment());
        fragmentList.add(new MineFragment());
        BasicFragmentAdapter adapter = new BasicFragmentAdapter(getSupportFragmentManager(), fragmentList, titleArray);
        viewPager.setAdapter(adapter);

        tabLayout.addOnTabSelectedListener(new TabLayout.OnTabSelectedListener() {
            @Override
            public void onTabSelected(TabLayout.Tab tab) {
                viewPager.setCurrentItem(tab.getPosition());
            }

            @Override
            public void onTabUnselected(TabLayout.Tab tab) {

            }

            @Override
            public void onTabReselected(TabLayout.Tab tab) {

            }
        });

        viewPager.addOnPageChangeListener(new ViewPager.OnPageChangeListener() {
            @Override
            public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {
                tabLayout.setScrollPosition(position,positionOffset,true);
            }

            @Override
            public void onPageSelected(int position) {

            }

            @Override
            public void onPageScrollStateChanged(int state) {

            }
        });

    }

}
```

这样就实现了切换ViewPager时对应的Tab也改变，切换Tab时对应的ViewPager也切换

<span style="background-color:#a2e043;"><b>运行结果：</b></span>

<img src="https://voyager0587.oss-cn-guangzhou.aliyuncs.com/%E7%AC%94%E8%AE%B0%E5%9B%BE%E7%89%87/202305211601357.gif" alt="device-2023-05-21-15_-original-original" style="zoom:25%;" />



### 四、商品分类页面













